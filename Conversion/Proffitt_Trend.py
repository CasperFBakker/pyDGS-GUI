import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from  matplotlib.pyplot import cm
import math

def power_fit(x, y, p=False):
  
  coefs = np.polyfit(np.log(x),np.log(y),1)
  a = np.exp(coefs[1])
  b = coefs[0]
  if p:
    print(a,b)

  return a*x**b 

def get_r2_numpy(x, y):
    slope, intercept = np.polyfit(np.log(x), np.log(y), 1)
    r_squared = 1 - (sum((np.log(y) - (slope * np.log(x) + intercept))**2) / ((len(y) - 1) * np.var(np.log(y), ddof=1)))
    return r_squared


def RMSE(Sieve_vals, DGS_vals):

    diffrnce = np.subtract(Sieve_vals, DGS_vals)
    sqre_err = np.square(diffrnce)
    rslt_meansqre_err = sqre_err.mean()
    root_meansqre_err = math.sqrt(rslt_meansqre_err)
    return root_meansqre_err


data = np.array(pd.read_csv('/home/casper/Documents/Python/pyDGS-GUI/Output data/26_10_22/Mobile/Uncorrected/Transform Maxsc8/Uncorrected_TransfAll_Sort.csv'))

sieve_data = np.array(pd.read_csv('/home/casper/Documents/Python/pyDGS-GUI/Output data/26_10_22/Sieve/Percentage_Sieve_Sort.csv'))
GrainSz = np.array([0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4])

color = cm.gist_rainbow(np.linspace(0, 1, 34))
plt.rcParams.update({'font.size': 14})
# plt.subplot(1,2,1)
for i in range(len(data)):
       plt.plot(GrainSz, (sieve_data[i,2:14]/data[i,2:14]),  color=color[i], label=sieve_data[i,0])

# plt.plot(GrainSz, power_fit(GrainSz, (sieve_data[0,2:14]/data[0,2:14]), True),label='power-fit', color='k')

plt.ylabel('%-Sieve / %-pyDGS', fontsize=18)
plt.xlabel('Grain size (mm)', fontsize=18)
plt.xscale('log'); plt.yscale('log')
plt.legend(bbox_to_anchor=(1,1), loc="upper left")
plt.show()
# plt.subplot(1,2,2)
GrainSz =  np.array([0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 
         0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4,
         0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4,
         0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 4, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4,
         0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4])

T = [0.009970464, 0.926786123, 16.87658136, 8.169001323, 2.258504119, 0.820357480, 0.287229839, 0.045347506, 0.001552619, 0.000731164, 
      0.011400404, 0.281745336, 6.273830042, 10.08058776, 4.598461696, 4.596895314, 1.252026824, 0.139469939, 0.003063357, 0.000885969, 
      0.035479839, 0.586910570, 8.247826620, 9.847588995, 5.713696972, 3.788831660, 2.282081966, 0.939039055, 0.140476223, 0.043796245, 0.021995549, 0.004304766,
      0.005907813, 0.933618788, 7.429548999, 9.777065441, 2.382603010, 1.785436246, 0.468400417, 0.085658929, 0.005844130, 0.001047785, 0.001157231, 0.005406778, 
      0.006289253, 0.536159961, 8.694465437, 8.897370897, 4.907957597, 3.071517684, 0.926637220, 0.153858744, 0.006157923, 0.002308614, 0.000790765, 0.001168569, 
      0.003839265, 0.918193751, 8.220718447, 11.40846892, 2.949495953, 2.735618370, 2.032928988, 1.411428392, 0.653199632, 0.369488582, 0.303810794, 0.420344837,
      0.011878847, 1.586519519, 13.44809621, 5.511145953, 0.750116662, 0.329454889, 0.105006266, 0.029788004, 0.010565593, 0.004242837, 0.066943356, 
      0.005560097, 0.354343920, 5.368828275, 7.887648498, 4.530547342, 4.074872800, 1.460170021, 0.786710112, 0.061785833, 0.011506923, 0.003774619, 0.013637385,
      0.024351945, 0.592872061, 7.024722938, 8.205608330, 3.775355901, 2.210551802, 1.116110571, 0.463142855, 0.117837935, 0.025139799, 0.015654121, 0.003372771]
plt.scatter(GrainSz, T, color='k')
plt.ylabel('%-Sieve / %-pyDGS')
plt.xlabel('Grain size (mm)')
plt.xscale('log'); plt.yscale('log')
plt.show()












# plt.scatter(GrainSz, (sieve_data[4,2:14] / data[1,2:14]))
# y = (sieve_data[4,2:14] / data[1,2:14]); y = y.astype(np.float64)
# x = GrainSz; x = x.astype(np.float64)

# plt.plot(x, power_fit(x,y, True),label='power-fit', color='k')
# plt.xscale('log'); plt.yscale('log')
# print('r^2', get_r2_numpy(x, y))
# print('RMSE', RMSE(y, power_fit(x,y)))
# plt.show()

# plt.subplot(1,3,1)
# plt.scatter(GrainSz[1:], (sieve_data[21,3:] / data[21,3:]))
# y = (sieve_data[21,3:] / data[21,3:]); y = y.astype(np.float64)
# x = GrainSz[1:]; x = x.astype(np.float64)

# plt.plot(x, power_fit(x,y, True),label='power-fit', color='k')
# plt.xscale('log'); plt.yscale('log')
# print('r^2', get_r2_numpy(x, y))
# print('RMSE', RMSE(y, power_fit(x,y)))
# print('=====================================================')
# plt.subplot(1,3,2)
plt.scatter(GrainSz, (sieve_data[3,2:14] / data[0,2:14]), label='DV')
plt.scatter(GrainSz, (sieve_data[4,2:14] / data[1,2:14]), label='Mid')
plt.scatter(GrainSz, (sieve_data[5,2:14] / data[2,2:14]), label='WL')
plt.legend()
plt.xscale('log'); plt.yscale('log')
plt.show()

y = (sieve_data[4,2:9] / data[1,2:9])
y = y.astype(np.float64)
x = GrainSz[0:7]
print(x)
x = x.astype(np.float64)
plt.plot(x, power_fit(x,y, True),label='power-fit', color='k')
print('r^2', get_r2_numpy(x, y))
print('RMSE', RMSE(y, power_fit(x,y)))
print('----------------------------------------')

y = (sieve_data[4,9:14] / data[1,9:14])
y = y.astype(np.float64)
x = GrainSz[7:] 
x = x.astype(np.float64)
plt.plot(x, power_fit(x,y, True),label='power-fit', color='k')
print('r^2', get_r2_numpy(x, y))
print('RMSE', RMSE(y, power_fit(x,y)))

plt.xscale('log'); plt.yscale('log')

# plt.subplot(1,3,3)
# plt.scatter(GrainSz, (sieve_data[21,2:] / data[21,2:]))

# y = (sieve_data[21,2:6] / data[21,2:6])
# y = y.astype(np.float64)
# x = GrainSz[0:4] 
# x = x.astype(np.float64)
# plt.plot(x, power_fit(x,y),label='power-fit', color='k')
# print('r^2',get_r2_numpy(x, y))
# print('RMSE',RMSE(y, power_fit(x,y, True)))

# y = (sieve_data[21,6:10] / data[21,6:10])
# y = y.astype(np.float64)
# x = GrainSz[4:8] 
# x = x.astype(np.float64)
# plt.plot(x, power_fit(x,y),label='power-fit', color='k')
# print('r^2',get_r2_numpy(x, y))
# print('RMSE',RMSE(y, power_fit(x,y, True)))

# y = (sieve_data[21,10:] / data[21,10:])
# y = y.astype(np.float64)
# x = GrainSz[8:] 
# x = x.astype(np.float64)
# plt.plot(x, power_fit(x,y),label='power-fit', color='k')
# print('r^2',get_r2_numpy(x, y))
# print('RMSE',RMSE(y, power_fit(x,y, True)))

# plt.xscale('log'); plt.yscale('log')

plt.show()



















































x = [0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8,
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4,  
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8,
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
            0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4,  
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8,
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4,  
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8,
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8,
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
            0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4,  
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8,
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
            0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8,
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4,  
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8,
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8, 
     0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.500, 0.710, 1, 2, 4, 8]
     
y = [0.005022437, 0.062269681, 0.388433001, 1.205711946, 1.472643017, 1.751699262, 1.912040197, 2.961429071, 3.241606420, 1.354580700, 0.252808968, 0.106591552, 0.005690591,
     0.018299314, 0.348762292, 0.980825528, 2.672470218, 2.304574701, 2.451298675, 1.675600273, 2.086332127, 2.582421092, 0.715354495, 0.064918249, 0.018012989,             
     0.008630526, 0.096256971, 0.443474156, 1.231733490, 1.432935036, 1.909153473, 2.099206976, 2.115499590, 2.156162757, 1.584460779, 0.730702599, 0.226232034, 0.001285389,
     0.008836801, 0.265828325, 0.898685451, 2.805892021, 2.097630815, 1.989602527, 1.365664624, 1.609307147, 2.344367542, 1.248187736, 0.259397024, 0.071316374, 0.282893030,
     0.058205976, 1.998107249, 5.101547425, 4.658412922, 2.475535667, 1.231377807, 0.911117688, 0.982523769, 1.307304344, 1.148907008, 0.281873090, 0.097397218,             
     0.014909909, 0.215891188, 0.799153720, 1.416953957, 1.543593673, 0.913826955, 0.591593855, 0.909310877, 1.495635095, 1.789612126, 1.363885174, 0.306175795, 0.066139908,
     0.017351082, 0.423697730, 1.056068440, 3.179221307, 2.289765415, 2.063899781, 1.208767706, 1.064606384, 1.261055776, 1.306237613, 0.446783359, 0.219674812, 0.082776515,
                  0.162318832, 0.686267552, 1.716172506, 1.939771625, 1.279166599, 1.296941420, 1.809165927, 2.131770853, 1.338161861, 0.336197998, 0.069340704,                           
     0.009548930, 0.133037632, 0.565001314, 1.919320553, 1.281541595, 1.199059094, 0.897942766, 1.329570575, 2.520063502, 2.100510633, 0.623151949, 0.212714868,              
     0.269359576, 3.892597480, 6.837352334, 10.25896551, 3.973053986, 2.331899718, 1.163082127, 0.592842005, 0.527883652, 1.072094180, 0.531273603, 0.277119469, 0.184891867,
     0.033319119, 0.208331754, 0.628755352, 1.523370565, 1.283756327, 0.892024179, 0.780909846, 0.892631217, 1.097020036, 1.280071640, 1.017283371, 0.841139979, 2.370630321,
     0.009315187, 0.097639340, 0.584161434, 1.771780576, 1.204071105, 1.853284718, 1.243232415, 1.245478437, 2.029159194, 1.954423461, 0.558890252, 0.198858731,               
     0.066316344, 0.178123813, 0.541380856, 2.205256384, 1.850739336, 1.260940307, 0.593752167, 0.355907432, 0.619362977, 2.758806783, 1.320888012, 0.492910189,               
     0.027939826, 0.177906446, 0.804710851, 3.467350139, 3.173246736, 4.328418596, 2.124747110, 1.227350063, 0.831539918, 0.691636213, 0.298933788, 0.194879410, 0.141992377,
     0.007620856, 0.102286612, 0.241232103, 0.808621625, 0.758747562, 1.220715469, 1.360385939, 2.233285173, 2.833041499, 1.510658062, 0.409755647, 0.085466284, 0.219986588,
     0.012408817, 0.401479257, 1.822403234, 3.269408607, 2.273498866, 1.704153238, 1.050938016, 0.935118730, 1.146001124, 1.134468776, 0.523428616, 0.248565120, 0.513890195,
     0.023583642, 0.430145982, 1.160807158, 4.159004773, 3.607398232, 3.980266979, 2.386616824, 1.235631149, 0.990738645, 0.480153117, 0.096248126, 0.031795175, 0.001415086,
                  0.062148692, 0.279566062, 1.348611412, 2.144175658, 2.892973544, 2.343166664, 2.259947452, 1.981580365, 1.308766760, 0.479102363, 0.216516940,              
     0.005799739, 0.118944196, 0.492185296, 1.739460817, 1.972133776, 2.688024891, 1.836698093, 2.590546229, 2.226594649, 1.251569716, 0.530451027, 0.132311977,              
     0.017132163, 0.234820342, 0.632309596, 1.397843041, 1.480827604, 1.948053686, 2.042915940, 2.887359285, 2.359679003, 1.178964886, 0.375020191, 0.126085962, 0.001501977,
     0.001252748, 0.178116494, 0.501993400, 1.368268656, 1.151190190, 1.720911204, 1.460779125, 2.118951298, 3.422983933, 2.121727681, 0.397756712, 0.047083639, 0.001420067,
                  0.113939823, 0.702734990, 1.942125947, 2.209902129, 3.371847442, 3.096300924, 3.220958178, 2.356317617, 0.866785632, 0.206929292, 0.046818398, 0.001156417,
     0.002548012, 0.078608647, 0.289167171, 0.974157933, 1.211546623, 2.424488520, 2.677476330, 3.361200019, 3.176529926, 1.752282410, 0.432769895, 0.157885506, 0.001200421,
     0.005075127, 0.266289101, 1.024416711, 2.332396491, 2.304696676, 2.148136717, 1.928710559, 2.324363232, 1.973829553, 1.253365833, 0.422863791, 0.114726854,               
     0.004181034, 0.188397939, 0.518840118, 1.360449954, 1.585811234, 2.451256426, 2.110104470, 2.445359693, 2.192286093, 1.525085974, 0.602065479, 0.189245558,              
     0.014093826, 0.239450388, 0.698632694, 1.965910500, 2.030890050, 3.192124151, 3.031083515, 3.845696913, 3.211834217, 0.889506699, 0.100899890, 0.020474358,               
     0.005258423, 0.194854389, 0.748334986, 1.687890154, 1.437679883, 1.805089291, 1.763777129, 2.677570037, 2.400961758, 1.642795421, 0.685992652, 0.180521670, 0.001129600,
     0.004309154, 0.130773620, 0.317549404, 0.795739706, 0.630075652, 1.223541006, 1.203136573, 2.354499728, 3.141967170, 2.209886647, 0.900008204, 0.199108211,              
     0.011284073, 0.332789036, 0.877457469, 1.413195322, 1.195217312, 1.592166304, 1.837362929, 2.820463807, 2.773807498, 1.448748301, 0.548190680, 0.178337418, 0.201568637,
     0.006220398, 0.115577669, 0.232084294, 0.746262387, 0.814899720, 1.897621106, 2.450890340, 3.724401556, 2.596317401, 1.496144717, 0.270159887, 0.109312343,               
     0.003623317, 0.064691545, 0.140822943, 0.436189950, 0.230195515, 0.644257144, 0.906843952, 1.506395027, 1.796562698, 2.369410124, 1.478087673, 0.470159746, 0.273412096,
     0.005339025, 0.128336461, 0.334870868, 0.705888480, 0.550555314, 1.258920054, 1.961415863, 4.206388816, 3.056608273, 1.555501844, 0.480177978, 0.152622718, 0.001366269,
     0.012655094, 0.190914147, 0.305244672, 0.512486523, 0.340167885, 1.220393895, 2.344882502, 4.344564724, 3.015437709, 1.291432417, 0.618520550, 0.527721668, 0.987274969,
     0.040891044, 0.238115401, 0.178844560, 0.166207306, 0.144613915, 0.447195098, 1.812630442, 4.568898122, 3.503420417, 1.323990068, 0.389315395, 0.252894880, 0.604167757]


plt.subplot(2,1,1)
color = cm.gist_rainbow(np.linspace(0, 1, 34))

for i in range(len(data)):
  sieve_data2 = sieve_data[i,2:]
  sieve_data2.astype(np.float64)
  sieve_data2[sieve_data2 == 0] = np.nan

  data2 = data[i,2:]
  data2.astype(np.float64)
  data2[data2 == 0] = np.nan
  plt.scatter(GrainSz, (sieve_data2/data2), color=color[i], label=sieve_data[i,0])


plt.plot(x, power_fit(x,y, True),label='power-fit', color='k')
plt.xscale('log'); plt.yscale('log')
plt.ylabel('p(V-W)/p(A-S)', fontsize=20)
plt.legend(bbox_to_anchor=(1,1), loc="upper left")
x_1 = [0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,
       0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,
       0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,        0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,
       0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,
       0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,
       0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,        0.125, 0.180, 0.250, 0.300, 0.355, 0.425,
       0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,
              0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,
       0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,
       0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,
       0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425, 0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,
       0.063, 0.125, 0.180, 0.250, 0.300, 0.355, 0.425,]
y_1 = [0.005022437, 0.062269681, 0.388433001, 1.205711946, 1.472643017, 1.751699262, 1.912040197, 0.018299314, 0.348762292, 0.980825528, 2.672470218, 2.304574701, 2.451298675, 1.675600273, 
       0.008630526, 0.096256971, 0.443474156, 1.231733490, 1.432935036, 1.909153473, 2.099206976,  0.008836801, 0.265828325, 0.898685451, 2.805892021, 2.097630815, 1.989602527, 1.365664624, 
       0.058205976, 1.998107249, 5.101547425, 4.658412922, 2.475535667, 1.231377807, 0.911117688, 0.014909909, 0.215891188, 0.799153720, 1.416953957, 1.543593673, 0.913826955, 0.591593855, 
       0.017351082, 0.423697730, 1.056068440, 3.179221307, 2.289765415, 2.063899781, 1.208767706,              0.162318832, 0.686267552, 1.716172506, 1.939771625, 1.279166599, 1.296941420, 
       0.009548930, 0.133037632, 0.565001314, 1.919320553, 1.281541595, 1.199059094, 0.897942766, 0.269359576, 3.892597480, 6.837352334, 10.25896551, 3.973053986, 2.331899718, 1.163082127, 
       0.033319119, 0.208331754, 0.628755352, 1.523370565, 1.283756327, 0.892024179, 0.780909846, 0.009315187, 0.097639340, 0.584161434, 1.771780576, 1.204071105, 1.853284718, 1.243232415, 
       0.066316344, 0.178123813, 0.541380856, 2.205256384, 1.850739336, 1.260940307, 0.593752167, 0.027939826, 0.177906446, 0.804710851, 3.467350139, 3.173246736, 4.328418596, 2.124747110, 
       0.007620856, 0.102286612, 0.241232103, 0.808621625, 0.758747562, 1.220715469, 1.360385939, 0.012408817, 0.401479257, 1.822403234, 3.269408607, 2.273498866, 1.704153238, 1.050938016, 
       0.023583642, 0.430145982, 1.160807158, 4.159004773, 3.607398232, 3.980266979, 2.386616824,              0.062148692, 0.279566062, 1.348611412, 2.144175658, 2.892973544, 2.343166664, 
       0.005799739, 0.118944196, 0.492185296, 1.739460817, 1.972133776, 2.688024891, 1.836698093, 0.017132163, 0.234820342, 0.632309596, 1.397843041, 1.480827604, 1.948053686, 2.042915940, 
       0.001252748, 0.178116494, 0.501993400, 1.368268656, 1.151190190, 1.720911204, 1.460779125,              0.113939823, 0.702734990, 1.942125947, 2.209902129, 3.371847442, 3.096300924, 
       0.002548012, 0.078608647, 0.289167171, 0.974157933, 1.211546623, 2.424488520, 2.677476330, 0.005075127, 0.266289101, 1.024416711, 2.332396491, 2.304696676, 2.148136717, 1.928710559, 
       0.004181034, 0.188397939, 0.518840118, 1.360449954, 1.585811234, 2.451256426, 2.110104470, 0.014093826, 0.239450388, 0.698632694, 1.965910500, 2.030890050, 3.192124151, 3.031083515, 
       0.005258423, 0.194854389, 0.748334986, 1.687890154, 1.437679883, 1.805089291, 1.763777129, 0.004309154, 0.130773620, 0.317549404, 0.795739706, 0.630075652, 1.223541006, 1.203136573, 
       0.011284073, 0.332789036, 0.877457469, 1.413195322, 1.195217312, 1.592166304, 1.837362929,  0.006220398, 0.115577669, 0.232084294, 0.746262387, 0.814899720, 1.897621106, 2.450890340, 
       0.003623317, 0.064691545, 0.140822943, 0.436189950, 0.230195515, 0.644257144, 0.906843952,  0.005339025, 0.128336461, 0.334870868, 0.705888480, 0.550555314, 1.258920054, 1.961415863, 
       0.012655094, 0.190914147, 0.305244672, 0.512486523, 0.340167885, 1.220393895, 2.344882502, 0.040891044, 0.238115401, 0.178844560, 0.166207306, 0.144613915, 0.447195098, 1.812630442, ]
x_2 = [0.500, 0.710, 1, 2, 4, 8,  0.500, 0.710, 1, 2, 4, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 0.500, 0.710, 1, 2, 4, 8,
       0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 0.500, 0.710, 1, 2, 4, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 
       0.500, 0.710, 1, 2, 4, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 
       0.500, 0.710, 1, 2, 4, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 
       0.500, 0.710, 1, 2, 4,  0.500, 0.710, 1, 2, 4,  0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 
       0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 8, 0.500, 0.710, 1, 2, 4, 8]
y_2 = [2.961429071, 3.241606420, 1.354580700, 0.252808968, 0.106591552, 0.005690591,  2.086332127, 2.582421092, 0.715354495, 0.064918249, 0.018012989,             
       2.115499590, 2.156162757, 1.584460779, 0.730702599, 0.226232034, 0.001285389, 1.609307147, 2.344367542, 1.248187736, 0.259397024, 0.071316374, 0.282893030,
       0.982523769, 1.307304344, 1.148907008, 0.281873090, 0.097397218, 0.909310877, 1.495635095, 1.789612126, 1.363885174, 0.306175795, 0.066139908,
       1.064606384, 1.261055776, 1.306237613, 0.446783359, 0.219674812, 0.082776515, 1.809165927, 2.131770853, 1.338161861, 0.336197998, 0.069340704,             
       1.329570575, 2.520063502, 2.100510633, 0.623151949, 0.212714868,              0.592842005, 0.527883652, 1.072094180, 0.531273603, 0.277119469, 0.184891867,
       0.892631217, 1.097020036, 1.280071640, 1.017283371, 0.841139979, 2.370630321, 1.245478437, 2.029159194, 1.954423461, 0.558890252, 0.198858731,             
       0.355907432, 0.619362977, 2.758806783, 1.320888012, 0.492910189,             1.227350063, 0.831539918, 0.691636213, 0.298933788, 0.194879410, 0.141992377,
       2.233285173, 2.833041499, 1.510658062, 0.409755647, 0.085466284, 0.219986588, 0.935118730, 1.146001124, 1.134468776, 0.523428616, 0.248565120, 0.513890195,
       1.235631149, 0.990738645, 0.480153117, 0.096248126, 0.031795175, 0.001415086, 2.259947452, 1.981580365, 1.308766760, 0.479102363, 0.216516940,             
       2.590546229, 2.226594649, 1.251569716, 0.530451027, 0.132311977,             2.887359285, 2.359679003, 1.178964886, 0.375020191, 0.126085962, 0.001501977,
       2.118951298, 3.422983933, 2.121727681, 0.397756712, 0.047083639, 0.001420067, 3.220958178, 2.356317617, 0.866785632, 0.206929292, 0.046818398, 0.001156417,
       3.361200019, 3.176529926, 1.752282410, 0.432769895, 0.157885506, 0.001200421, 2.324363232, 1.973829553, 1.253365833, 0.422863791, 0.114726854,             
       2.445359693, 2.192286093, 1.525085974, 0.602065479, 0.189245558,              3.845696913, 3.211834217, 0.889506699, 0.100899890, 0.020474358,             
       2.677570037, 2.400961758, 1.642795421, 0.685992652, 0.180521670, 0.001129600, 2.354499728, 3.141967170, 2.209886647, 0.900008204, 0.199108211,             
       2.820463807, 2.773807498, 1.448748301, 0.548190680, 0.178337418, 0.201568637, 3.724401556, 2.596317401, 1.496144717, 0.270159887, 0.109312343,             
       1.506395027, 1.796562698, 2.369410124, 1.478087673, 0.470159746, 0.273412096, 4.206388816, 3.056608273, 1.555501844, 0.480177978, 0.152622718, 0.001366269,
       4.344564724, 3.015437709, 1.291432417, 0.618520550, 0.527721668, 0.987274969, 4.568898122, 3.503420417, 1.323990068, 0.389315395, 0.252894880, 0.604167757]
plt.subplot(2,1,2)
for i in range(len(data)):
  sieve_data2 = sieve_data[i,2:]
  sieve_data2.astype(np.float64)
  sieve_data2[sieve_data2 == 0] = np.nan

  data2 = data[i,2:]
  data2.astype(np.float64)
  data2[data2 == 0] = np.nan
  plt.scatter(GrainSz, (sieve_data2/data2), color=color[i])
plt.plot(x_1, power_fit(x_1,y_1, True),label='power-fit', color='k')
plt.plot(x_2, power_fit(x_2,y_2, True),label='power-fit', color='k')
plt.xscale('log'); plt.yscale('log')
plt.ylabel('p(V-W)/p(A-S)', fontsize=20)
plt.xlabel('Grain size (mm)', fontsize=20)

plt.show()

